<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Documentation - pyclewn</title>
<meta name="Generator" content="Vim/7.2">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style type="text/css">
<!--
.Identifier { color: #0000ff; }
.PreProc { color: #a020f0; }
.Statement { color: #a52a2a; }
.Comment { color: #ff0000; }
.Special { color: #ff00ff; }
.Type { color: #0000ff; }
.Todo { color: #0000ff; background-color: #ffff00; }
pre { font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
.Ignore { color: #ffffff; }
.Constant { color: #ff00ff; }
-->
</style>
</head>
<body>
<pre>
<span class="Ignore">*</span><span class="Constant">pyclewn.txt</span><span class="Ignore">*</span>                                   Last change: 2009 April 7


                            PYCLEWN USER MANUAL

The Pyclewn user guide                              <span class="Ignore">*</span><span class="Constant">pyclewn</span><span class="Ignore">*</span>

1. Introduction                                     <span class="Ignore">|</span><span class="Identifier">pyclewn-intro</span><span class="Ignore">|</span>
2. Starting pyclewn                                 <span class="Ignore">|</span><span class="Identifier">pyclewn-starting</span><span class="Ignore">|</span>
3. Using pyclewn                                    <span class="Ignore">|</span><span class="Identifier">pyclewn-using</span><span class="Ignore">|</span>
4. Gdb                                              <span class="Ignore">|</span><span class="Identifier">pyclewn-gdb</span><span class="Ignore">|</span>
5. Windows                                          <span class="Ignore">|</span><span class="Identifier">pyclewn-windows</span><span class="Ignore">|</span>
6. Key mappings                                     <span class="Ignore">|</span><span class="Identifier">pyclewn-mappings</span><span class="Ignore">|</span>
7. Watched variables                                <span class="Ignore">|</span><span class="Identifier">pyclewn-variable</span><span class="Ignore">|</span>
8. Extending pyclewn                                <span class="Ignore">|</span><span class="Identifier">pyclewn-extending</span><span class="Ignore">|</span>


<span class="PreProc">==============================================================================</span>
1. Introduction                                     <span class="Ignore">*</span><span class="Constant">pyclewn-intro</span><span class="Ignore">*</span>


Pyclewn is a python program that allows the use of gvim as a front end to a
debugger. Pyclewn uses the netbeans protocol to control gvim.

The debugger output is redirected to a vim window, the<span class="Ignore">|</span><span class="Identifier">pyclewn-console</span><span class="Ignore">|</span>. The
debugger commands are mapped to vim user-defined commands with a common letter
prefix (the default is the<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>letter), and with vim command completion
available on the commands and their first argument.

On unix, the controlling terminal of the program to debug is the terminal used
to launch pyclewn, or any other terminal when the debugger allows it (for
example, gdb with the attach and tty commands).

On Windows, gdb pops up a console attached to the program to debug.


Pyclewn currently supports the following debuggers:

<span class="Statement">    </span>* gdb:      version 6.2.1 and above
                pyclewn uses the gdb MI interface

<span class="Statement">    </span>* simple:   a fake debugger implemented in python to test pyclewn
                internals


Pyclewn provides the following features:
<span class="PreProc">---------------------------------------</span>

* A debugger command can be mapped in vim to a key sequence using vim key
  mappings. This allows, for example, to set/clear a breakpoint or print a
  variable value at the current cursor or mouse position by just hitting a
  key.

* A sequence of gdb commands can be run from a vim script when the
 <span class="Ignore">|</span><span class="Identifier">async-option</span><span class="Ignore">|</span>is set. This may be useful in a key mapping.

* Breakpoints and the line in the current frame are highlighted in the source
  code. Disabled breakpoints are noted with a different highlighting color.
  Pyclewn automatically finds the source file for the breakpoint if it exists,
  and tells vim to load and display the file and highlight the line.

* The value of an expression or variable is displayed in a balloon in vim
  when the mouse pointer is hovering over the selected expression or the
  variable.

* An expression can be watched in a vim window. The expression value is
  updated and highlighted whenever it has changed. When the expression is a
  structure or class instance, it can be expanded (resp. folded) to show
  (resp. hide) its members and their values.

* The<span class="Ignore">|</span><span class="Identifier">project-command</span><span class="Ignore">|</span>saves the current gdb settings to a project file that
  may be sourced later by the gdb &quot;source&quot; command. These settings are the
  working directory, the debuggee program file name, the program arguments and
  the breakpoints. The sourcing and saving of the project file can be
  automated to occur on each gdb startup and termination, whith the
 <span class="Ignore">|</span><span class="Identifier">project-file</span><span class="Ignore">|</span>command line option.

* Vim command completion on the commands and their first argument.


The remaining sections of this manual are:
<span class="PreProc">-----------------------------------------</span>

    2.<span class="Ignore">|</span><span class="Identifier">pyclewn-starting</span><span class="Ignore">|</span>lists the command line options and their usage.

    3.<span class="Ignore">|</span><span class="Identifier">pyclewn-using</span><span class="Ignore">|</span>explains how to use the pyclewn features common to all
       supported debuggers

    4.<span class="Ignore">|</span><span class="Identifier">pyclewn-gdb</span><span class="Ignore">|</span>details the topics relevant to pyclewn and the gdb
       debugger.

    5.<span class="Ignore">|</span><span class="Identifier">pyclewn-windows</span><span class="Ignore">|</span>describes what is specific to pyclewn on Windows.

    6.<span class="Ignore">|</span><span class="Identifier">pyclewn-mappings</span><span class="Ignore">|</span>lists the pyclewn key mappings and how to use them.

    7.<span class="Ignore">|</span><span class="Identifier">pyclewn-variable</span><span class="Ignore">|</span>explains how to use the variable debugger window.

    8.<span class="Ignore">|</span><span class="Identifier">pyclewn-extending</span><span class="Ignore">|</span>explains how to implement a new debugger in pyclewn


<span class="PreProc">==============================================================================</span>
2. Starting pyclewn                                 <span class="Ignore">*</span><span class="Constant">pyclewn-starting</span><span class="Ignore">*</span>


To use with gdb, pyclewn is usually simply started as:<span class="Ignore"> &gt;</span>

<span class="Comment">    pyclewn</span>

On Windows, pyclewn is started with a Desktop shortcut that runs pyclewn.bat.
The pyclewn.bat file is located in the Scripts directory of the Python
distribution.


The debugger is started by running a debugger command from vim command line.
For example, load foobar with the gdb command &quot;file&quot; and start gbd by typing
on the vim command line:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cfile foobar</span>

To just start gdb with a command that does not have any effect:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cecho</span>

<span class="Statement">.                                                   </span><span class="Ignore">*</span><span class="Constant">Ccommand</span><span class="Ignore">*</span> <span class="Ignore">*</span><span class="Constant">C</span><span class="Ignore">*</span>
The prefix letter<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>is the default vim command prefix used to map debugger
commands to vim user-defined commands. These commands are called<span class="Ignore">|</span><span class="Identifier">Ccommand</span><span class="Ignore">|</span>in
this manual. The prefix can be changed with a command line option.


To restart a new instance of the debugger, quit the current debugger instance
and start the new instance by running any debugger command from vim (except
&quot;quit&quot; of course).


Pyclewn can be started with the following options:


options:
  --version                   show program's version number and exit
  -h, --help                  show this help message and exit
  -s, --simple                select the simple debugger
  -g PARAM_LIST, --gdb=PARAM_LIST
                              select the gdb application (the default), with a
                              mandatory, possibly empty, PARAM_LIST
  -d, --daemon                run as a daemon (default 'False')
  -p PGM, --pgm=PGM           set the debugger program to PGM
  -a ARGS, --args=ARGS        set the debugger program arguments to ARGS
  -e EDITOR, --editor=EDITOR  set the editor program to EDITOR (default
                              gvim)
  -c ARGS, --cargs=ARGS       set the editor program arguments to ARGS
  -w LOCATION, --window=LOCATION
                              open the debugger console window at LOCATION
                              which may be one of (top, bottom, left,
                              right), the default is top
  -m LNUM, --maxlines=LNUM    set the maximum number of lines of the debugger
                              console window to LNUM (default 10000 lines)
  -x PREFIX, --prefix=PREFIX  set the commands prefix to PREFIX (default<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>)
  -n CONN, --netbeans=CONN    set netBeans connection parameters to CONN with
                              CONN as 'host[:port[:passwd]]', (the default is
                              ':3219:changeme' where the empty host represents
                              INADDR_ANY)
  -l LEVEL, --level=LEVEL     set the log level to LEVEL: critical, error,
                              warning, info, debug or nbdebug (default error)
  -f FILE, --file=FILE        set the log file name to FILE


<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">pyclewn-options</span><span class="Ignore">*</span>
The full description of the command line options follows:
<span class="PreProc">--------------------------------------------------------</span>

--version           Show program's version number and exit.

-h
--help              Show this help message and exit.

-s
--simple            Select the simple debugger. In that case, the --pgm and
                    --args options are meaningless. The simple debugger is
                    documented in debugger/simple.py, in the source
                    distribution.

-g {PARAM_LIST}
--gdb={PARAM_LIST}  Select the gdb debugger (the default). The default value
                    of the &quot;pgm&quot; option is &quot;gdb&quot;. The PARAM_LIST option
                    parameter is a comma separated list of parameters and is
                    mandatory when the option is present. So, to run gdb with
                    no specific parameter, the following commands are
                    equivalent:<span class="Ignore"> &gt;</span>

<span class="Comment">                        pyclewn</span>
<span class="Comment">                        pyclewn -g &quot;&quot;</span>
<span class="Comment">                        pyclewn --gdb=</span>
.
                    There are two optional parameters:

<span class="Statement">                        </span>* the &quot;async&quot; keyword sets the<span class="Ignore">|</span><span class="Identifier">async-option</span><span class="Ignore">|</span>
<span class="Statement">                        </span>* the project file name sets the<span class="Ignore">|</span><span class="Identifier">project-file</span><span class="Ignore">|</span>

                    The project file name can be an absolute pathname, a
                    relative pathname starting with '.' or a home relative
                    pathname starting with '~'. The directory of the project
                    file name must be an existing directory.
                    For example on unix:<span class="Ignore"> &gt;</span>

<span class="Comment">                        pyclewn --gdb=async,./project_name</span>

-d
--daemon            Run as a daemon (default 'False'): on unix, pyclewn is
                    detached from the terminal from where it has been
                    launched, which means that this terminal cannot be used as
                    a controlling terminal for the program to debug, and
                    cannot be used for printing the pyclewn logs as well.
                    On Windows, this option hides the pyclewn Windows console
                    and it is set on the shortcut that is installed on the
                    Desktop.

-p <span class="Special">{PGM}</span>
--pgm=<span class="Special">{PGM}</span>         Set the debugger program to PGM. PGM must be in one of the
                    directories listed in the PATH environment variable.

-a <span class="Special">{ARGS}</span>
--args=<span class="Special">{ARGS}</span>       Set the debugger program arguments to ARGS. These
                    arguments may be double quoted. For example, start gdb
                    with the program foobar and &quot;this is foobar argument&quot; as
                    foobar's argument:<span class="Ignore"> &gt;</span>

<span class="Comment">                    pyclewn -a '--args foobar &quot;this is foobar argument&quot;'</span>

-e <span class="Special">{EDITOR}</span>
--editor=<span class="Special">{EDITOR}</span>   Set the editor program to EDITOR (default gvim). EDITOR
                    must be in one of the directories listed in the PATH
                    environment variable.

-c <span class="Special">{ARGS}</span>
--cargs=<span class="Special">{ARGS}</span>      Set the editor program arguments to ARGS, possibly double
                    quoted (same as option --args).

-w <span class="Special">{LOCATION}</span>
--window=<span class="Special">{LOCATION}</span> The debugger console window pops up at LOCATION, which may
                    be one of top, bottom, left or right. The default is top.
                    In the left or right case, the window pops up on the left
                    (resp. right) if there is only one window currently
                    displayed, otherwise the debugger window is opened at the
                    default top.

-m <span class="Special">{LNUM}</span>
--maxlines=<span class="Special">{LNUM}</span>   Set the maximum number of lines of the debugger console
                    window to LNUM (default 10000 lines). When the number of
                    lines in the buffer reaches LNUM, 10% of LNUM first lines
                    are deleted from the buffer.

-x <span class="Special">{PREFIX}</span>
--prefix=<span class="Special">{PREFIX}</span>   Set the user defined vim commands prefix to PREFIX
                    (default<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>). The prefix may be more than one letter
                    long. The first letter must be upper case.

-n <span class="Special">{CONN}</span>
--netbeans=<span class="Special">{CONN}</span>   Set netBeans connection parameters to CONN with CONN as
                    'host[:port[:passwd]]', (the default is ':3219:changeme'
                    where the empty host represents INADDR_ANY). Pyclewn
                    listens on host:port, with host being a name or the IP
                    address of one of the local network interfaces in standard
                    dot notation. These parameters must match those used by
                    gvim for the connection to succeed.

-l <span class="Special">{LEVEL}</span>
--level=<span class="Special">{LEVEL}</span>     Set the log level to LEVEL: critical, error, warning, info,
                    debug or nbdebug (default error). Level nbdebug is very
                    verbose and logs all the netbeans pdu as well as all the
                    debug traces.

-f <span class="Special">{FILE}</span>
--file=<span class="Special">{FILE}</span>       Set the log file name to FILE.


On unix, when the 'CLEWN_PIPES' environment variable is set, pyclewn uses
pipes instead of a pseudo tty and emulates the select event loop with threads.
When the 'CLEWN_POPEN' environment variable is set, pyclewn uses pipes instead
of a pseudo tty but continues using the select event loop. These variables are
mainly used for regression testing.


<span class="PreProc">==============================================================================</span>
3. Using pyclewn                            <span class="Ignore">*</span><span class="Constant">pyclewn-using</span><span class="Ignore">*</span> <span class="Ignore">*</span><span class="Constant">pyclewn-console</span><span class="Ignore">*</span>


Console:
<span class="PreProc">--------</span>
The debugger output is redirected to a vim window: the console.

The console window pops up whenever a<span class="Ignore">|</span><span class="Identifier">Ccommand</span><span class="Ignore">|</span>is entered on vim command line
or a key mapped by pyclewn is hit.

The initial console window height is set with the vim option <span class="Type">'previewheight'</span>
that defaults to 12 lines.


Commands:
<span class="PreProc">---------</span>
A debugger command can be entered on vim command line with the<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>prefix. It is
also possible to enter the command as the first argument of the<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>command. In
the following example with gdb, both methods are equivalent:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cfile /path/to/foobar</span>
<span class="Comment">    :C file /path/to/foobar</span>

The first method provides completion on the file name while the second one
does not.

The second method is useful when the command is a user defined command in the
debugger (user defined commands built by <span class="Special">&lt;define&gt;</span> in gdb), and therefore not a
vim command. It is also needed for gdb command names that cannot be mapped to
a vim command because vim does not accept non alphanumeric characters within
command names (for example <span class="Special">&lt;core-file&gt;</span> in gdb).

To get help on the pyclewn commands, use Chelp.

Pyclewn commands can be mapped to keys, or called within a Vim script or a
menu.

<span class="Todo">Note</span>:
The gdb debugger cannot handle requests asynchronously, so the
<span class="Ignore">|</span><span class="Identifier">async-option</span><span class="Ignore">|</span>must be set, when mapping a key to a sequence of commands.
With this option set, one can build for example the following mapping:<span class="Ignore"> &gt;</span>

<span class="Comment">    :map &lt;F8&gt; :Cfile /path/to/foobar &lt;Bar&gt; Cbreak main &lt;Bar&gt; Crun &lt;CR&gt;</span>

<span class="Todo">Note</span>:
Quotes and backslashes must be escaped on vim command line. For example, to
print foo with a string literal as first argument to the foo function:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cprint foo(\&quot;foobar\&quot;, 1)</span>

And to do the same thing with the string including a new line:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cprint foo(\&quot;foobar\\n\&quot;, 1)</span>


Completion:
<span class="PreProc">-----------</span>
Command line completion in vim is usually done using the <span class="Special">&lt;Tab&gt;</span> key (set by the
<span class="Type">'wildchar'</span> option). To get the list of all valid completion matches, type
<span class="Special">CTRL-D</span>. For example, to list all the debugger commands (assuming the
default<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>prefix is being used):<span class="Ignore"> &gt;</span>

<span class="Comment">    :C&lt;C-D&gt;</span>

See also the <span class="Type">'wildmenu'</span> option. With this option, the possible matches are
shown just above the command line and can be selected with the arrow keys.

The first argument completion of a<span class="Ignore">|</span><span class="Identifier">Ccommand</span><span class="Ignore">|</span>may be done on a file name or on a
list. For example with gdb, the following command lists all the gdb help
items:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Chelp &lt;C-D&gt;</span>

The first argument completion of the<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>command is the list of all the debugger
commands. For example, to list all the debugger commands (<span class="Todo">note</span> the space after
the<span class="Ignore">|</span><span class="Identifier">C</span><span class="Ignore">|</span>):<span class="Ignore"> &gt;</span>

<span class="Comment">    :C &lt;C-D&gt;</span>


Command line search:
<span class="PreProc">--------------------</span>
Use the powerful command line search capabilities of the Vim command line.
For example, you want to type again, possibly after a little editing, one of
the commands previously entered:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cprint (*(foo*)0x0123ABCD)-&gt;next-&gt;next-&gt;part1-&gt;something_else.aaa</span>

You can get rapidly to this command by using the Vim command line window
<span class="Ignore">|</span><span class="Identifier">cmdline-window</span><span class="Ignore">|</span>:<span class="Ignore"> &gt;</span>

<span class="Comment">    :&lt;CTRL-F&gt;</span>
<span class="Comment">    /something_else</span>
<span class="Comment">    &lt;CR&gt;</span>

or from normal mode<span class="Ignore"> &gt;</span>
<span class="Comment">    q:</span>
<span class="Comment">    /something_else</span>
<span class="Comment">    &lt;CR&gt;</span>


Balloon:
<span class="PreProc">--------</span>
A variable is evaluated by the debugger and displayed in a balloon in vim,
when the mouse pointer is hovering over the the variable. To get the
evaluation of an expression, first select the expression in visual mode in the
source code and point the mouse over the selected expression. To disable this
feature, set the vim option <span class="Type">'noballooneval'</span>.


Pyclewn commands:
<span class="PreProc">-----------------</span>
The<span class="Ignore">|</span><span class="Identifier">Ccommand</span><span class="Ignore">|</span>list includes all the debugger commands and some pyclewn specific
commands that are listed here:

<span class="Statement">    </span>*<span class="Ignore">|</span><span class="Identifier">Cdbgvar</span><span class="Ignore">|</span>       add a watched variable or expression to the
                    (clewn)_dbgvar buffer

<span class="Statement">    </span>*<span class="Ignore">|</span><span class="Identifier">Cdelvar</span><span class="Ignore">|</span>       delete a watched variable from the (clewn)_dbgvar buffer

<span class="Statement">    </span>* Cdumprepr      print on the console pyclewn internal structures that
                     may be used for debugging pyclewn

<span class="Statement">    </span>*<span class="Ignore">|</span><span class="Identifier">Cfoldvar</span><span class="Ignore">|</span>      collapse/expand the members of a watched structure or
                     class instance

<span class="Statement">    </span>* Chelp          print on the console, help on the pyclewn specific
                     commands (those on this list) in addition to the help on
                     the debugger commands

<span class="Statement">    </span>*<span class="Ignore">|</span><span class="Identifier">Cmapkeys</span><span class="Ignore">|</span>      map pyclewn keys

<span class="Statement">    </span>*<span class="Ignore">|</span><span class="Identifier">Cproject</span><span class="Ignore">|</span>      save the current gdb settings to a project file

<span class="Statement">    </span>* Csigint        send a <span class="Special">&lt;C-C&gt;</span> character to the debugger to interrupt the
                     running program that is being debugged; only with gdb,
                     and when pyclewn and gdb communicate over a pseudo
                     terminal, which means on unix but not on Windows;
                     on Windows, to interrupt the debuggee, one must type
                     <span class="Special">&lt;C-C&gt;</span> in the console that is popped by gdb on debuggee
                     start up

<span class="Statement">    </span>*<span class="Ignore">|</span><span class="Identifier">Csymcompletion</span><span class="Ignore">|</span>populate the break and clear commands with symbols
                     completion (only with gdb)

<span class="Statement">    </span>* Cunmapkeys     unmap the pyclewn keys, this vim command does not invoke
                     pyclewn

<span class="PreProc">==============================================================================</span>
4. Gdb                                              <span class="Ignore">*</span><span class="Constant">pyclewn-gdb</span><span class="Ignore">*</span>


<span class="Todo">Note</span>: One useful tutorial on gdb is Peter Jay Salzman's, at
<span class="Constant"><a href="http://www.dirac.org/linux/gdb/">http://www.dirac.org/linux/gdb/</a></span>.


When gdb is started, it automatically executes commands from its init file,
normally called '.gdbinit'. See gdb documentation.


Debuggee standard input and output:
<span class="PreProc">-----------------------------------</span>
On unix, when pyclewn is started from a terminal and not as a daemon, the
standard input and output of the program to debug are those of the terminal
from where pyclewn was started.

When pyclewn is run as a daemon, the <span class="Special">&lt;tty&gt;</span> gdb command, or the <span class="Special">&lt;attach&gt;</span> gdb
command can be used to control the input and output of the program to debug.

On Windows, gdb pops up a console attached to the program to debug.


<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">async-option</span><span class="Ignore">*</span>
Async option:
<span class="PreProc">-------------</span>
The gdb event loop is not asynchronous in most configurations, which means
that gdb cannot handle a command while the previous one is being processed and
discards it.
When gdb is run with the<span class="Ignore">|</span><span class="Identifier">async-option</span><span class="Ignore">|</span>set, pyclewn queues the commands in a
fifo and send a command to gdb, only when gdb is ready to process the command.
This allows the key mappings of a sequence of gdb commands. To set the
<span class="Ignore">|</span><span class="Identifier">async-option</span><span class="Ignore">|</span>, see<span class="Ignore">|</span><span class="Identifier">pyclewn-options</span><span class="Ignore">|</span>.


<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">gdb-keys</span><span class="Ignore">*</span>
List of gdb default key mappings:
<span class="PreProc">--------------------------------</span>
These keys are mapped after the<span class="Ignore">|</span><span class="Identifier">Cmapkeys</span><span class="Ignore">|</span>vim command is run.

        <span class="Special">CTRL-Z</span>  send an interrupt to gdb and the program it is running (unix
                only)
        B       info breakpoints
        L       info locals
        A       info args
        S       step
        <span class="Special">CTRL-N</span>  next: next source line, skipping all function calls
        F       finish
        R       run
        Q       quit
        C       continue
        W       where
        X       foldvar
        <span class="Special">CTRL-U</span>  up: go up one frame
        <span class="Special">CTRL-D</span>  down: go down one frame

<span class="PreProc">cursor position:</span><span class="Ignore"> ~</span>
        <span class="Special">CTRL-B</span>  set a breakpoint on the line where the cursor is located
        <span class="Special">CTRL-E</span>  clear all breakpoints on the line where the cursor is located

<span class="PreProc">mouse pointer position:</span><span class="Ignore"> ~</span>
        <span class="Special">CTRL-P</span>  print the value of the variable defined by the mouse pointer
                position
        <span class="Special">CTRL-X</span>  print the value that is referenced by the address whose
                value is that of the variable defined by the mouse pointer
                position


<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">$cdir</span><span class="Ignore">*</span>
Source path:
<span class="PreProc">-----------</span>
Pyclewn automatically locates the source file with the help of gdb, by using
the debugging information stored in the file that is being debugged. This is
useful when the program to debug is the result of multiple compilation units
located in different directories.


<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">Csymcompletion</span><span class="Ignore">*</span>
Symbols completion:
<span class="PreProc">-------------------</span>
The gdb <span class="Special">&lt;break&gt;</span> and <span class="Special">&lt;clear&gt;</span> commands are set initially with file name
completion. This can be changed to completion matching the symbols of the
program being debugged, after running the<span class="Ignore">|</span><span class="Identifier">Csymcompletion</span><span class="Ignore">|</span>command. This is a
pyclewn command.

To minimize the number of loaded symbols and to avoid fetching the shared
libraries symbols, run the Csymcompletion command after the file is loaded
with the gdb <span class="Special">&lt;file&gt;</span> command, and before the program is run.

<span class="Todo">Note</span>: The <span class="Special">&lt;break&gt;</span> and <span class="Special">&lt;clear&gt;</span> filename completion is not the same as gdb file
name completion for these two commands. Gdb uses the symbols found in the
program file to debug, while pyclewn uses only the file system.


<span class="Statement">                                            </span><span class="Ignore">*</span><span class="Constant">project-command</span><span class="Ignore">*</span> <span class="Ignore">*</span><span class="Constant">project-file</span><span class="Ignore">*</span>
Project file:
<span class="PreProc">-------------</span>
The pyclewn<span class="Ignore">|</span><span class="Identifier">project-command</span><span class="Ignore">|</span>name is &quot;project&quot;. This command saves the current
gdb settings to a project file that may be sourced later by the gdb &quot;source&quot;
command.

These settings are:
<span class="Statement">    </span>* current working directory
<span class="Statement">    </span>* debuggee program file name
<span class="Statement">    </span>* program arguments
<span class="Statement">    </span>* all the breakpoints (at most one breakpoint per source line is saved)

The argument of the<span class="Ignore">|</span><span class="Identifier">project-command</span><span class="Ignore">|</span>is the pathname of the project file.
For example:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cproject /path/to/project</span>

When the &quot;--gdb&quot; option is set with a project filename (see<span class="Ignore">|</span><span class="Identifier">pyclewn-options</span><span class="Ignore">|</span>),
the project file is automatically sourced when a a gdb session is started, and
the project file is automatically saved when the gdb session or vim session,
is terminated.

<span class="Todo">Note</span>: When gdb sources the project file and cannot set a breakpoint because,
for example, it was set in a shared library that was loaded at the time the
project file was saved, gdb ignores silently the breakpoint (see gdb help on
&quot;set breakpoint pending&quot;).


Limitations:
<span class="PreProc">------------</span>
The <span class="Special">&lt;define&gt;</span> command is not allowed. To build gdb user-defined commands in
pyclewn, edit the commands in a temporary file with vim, and load the
commands into gdb by using the gdb <span class="Special">&lt;source&gt;</span> command on this file.

The <span class="Special">&lt;commands&gt;</span> command is not allowed. To give a breakpoint a series of
commands to execute when the debuggee stops due to that breakpoint, edit the
commands in a temporary file with vim, and load the commands into gdb by using
the gdb <span class="Special">&lt;source&gt;</span> command on this file.

The project file is not saved automatically on exit, if gdb is busy running a
command at that time.

When pyclewn cannot setup a pseudo tty to communicate with gdb, pyclewn falls
back to pipes. In this case, the Csigint command does not work as gdb does not
handle interrupts over a pipe. Instead, one must send a SIGINT signal to the
debuggee in order to interrupt the debuggee while it is running. This can be
done from Vim with the command:<span class="Ignore"> &gt;</span>

<span class="Comment">    :!kill -SIGINT $(pgrep debuggee_process_name)</span>

On Windows, it is not possible to interrupt gdb with the Csigint command, but
you can type <span class="Special">&lt;Ctl-C&gt;</span> in the console to interrupt the debuggee.

When setting breakpoints on an overloaded method, pyclewn bypasses the gdb
prompt for the multiple choice and sets automatically all breakpoints.

In order to set a pending breakpoint (for example in a shared library that has
not yet been loaded by gdb), you must explicitly set the breakpoint pending
mode to &quot;on&quot;, with the command:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cset breakpoint pending on</span>

After a &quot;detach&quot; gdb command, the frame sign remains highlighted because
gdb/mi considers the frame as still valid.

When answering &quot;Abort&quot; to a dialog after pyclewn attempts to edit a buffer and
set a breakpoint in a file already opened within another Vim session, the
breakpoint is set in gdb, but not highlighted in the corresponding buffer.
However, it is possible to<span class="Ignore">|</span><span class="Identifier">bwipeout</span><span class="Ignore">|</span>a buffer at any time, and load it again in
order to restore the correct highlighting of all the breakpoints in the
buffer.


List of illegal gdb commands:
<span class="PreProc">-----------------------------</span>
The following gdb commands cannot be run from pyclewn:

        commands
        complete
        define
        edit
        end
        set annotate
        set confirm
        set height
        set width
        shell


<span class="PreProc">==============================================================================</span>
5. Windows                                          <span class="Ignore">*</span><span class="Constant">pyclewn-windows</span><span class="Ignore">*</span>

Installation:
<span class="PreProc">-------------</span>
See <span class="Constant"><a href="http://pyclewn.wiki.sourceforge.net/install">http://pyclewn.wiki.sourceforge.net/install</a></span> for installing pyclewn on
Windows.

If pyclewn does not start once installed, edit the desktop shortcut and add
&quot;-l debug -f \path\to\logfile.txt&quot; to the command line. Check the content of
logfile.txt.

When pyclewn stops with the following error in the logfile:

    gdb  CRITICAL cannot start gdb as &quot;C:\msys\mingw\bin\gdb.exe&quot;

This means you have to update the shortcut command line with the correct path
to gdb.


Interrupt the debuggee:
<span class="PreProc">-----------------------</span>
Gdb is started with the &quot;console-new&quot; gdb variable set to on. When you start
the debuggee, gdb pops up the console attached to the debuggee. You can type
<span class="Special">&lt;Ctl-C&gt;</span> in the console to interrupt the debuggee.

If this console bothers you, run the following gdb command:<span class="Ignore"> &gt;</span>

<span class="Comment">  :Cset new-console off</span>


Escape quotes:
<span class="PreProc">--------------</span>
The following is true as well for pyclewn on unix, but since pathnames
containing space characters are common on Windows, it may be useful to recall
that quotes must be escaped on Vim command line.
For example one could write:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cfile \&quot;\path with space\to\foobar.exe\&quot;</span>


<span class="PreProc">==============================================================================</span>
6. Key mappings                                     <span class="Ignore">*</span><span class="Constant">pyclewn-mappings</span><span class="Ignore">*</span>


All<span class="Ignore">|</span><span class="Identifier">Ccommand</span><span class="Ignore">|</span>can be mapped to vim keys using the vim<span class="Ignore">|</span><span class="Identifier">:map-commands</span><span class="Ignore">|</span>.
For example, to set a breakpoint at the current cursor position:<span class="Ignore"> &gt;</span>

<span class="Comment">    :map &lt;F8&gt; :exe &quot;Cbreak &quot; . expand(&quot;%:p&quot;) . &quot;:&quot; . line(&quot;.&quot;)&lt;CR&gt;</span>
.

<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">Cmapkeys</span><span class="Ignore">*</span>
Pyclewn key mappings:
<span class="PreProc">---------------------</span>
This section describes another mapping mechanism where pyclewn maps vim keys
by reading a configuration file. This is done when the<span class="Ignore">|</span><span class="Identifier">Cmapkeys</span><span class="Ignore">|</span>vim command is
run. The pyclewn keys mapping is mostly useful for the pyclewn casual user.
When the configuration file cannot be found, pyclewn sets the default key
mappings. See<span class="Ignore">|</span><span class="Identifier">gdb-keys</span><span class="Ignore">|</span>for the list of default key mappings for gdb.

The configuration file is named .pyclewn_keys.<span class="Special">{debugger}</span>, where debugger is
the name of the debugger. The default placement for this file is
$CLEWNDIR/.pyclewn_keys.<span class="Special">{debugger}</span>, or $HOME/.pyclewn_keys.<span class="Special">{debugger}</span>.

To customize pyclewn key mappings copy the configurations files found in the
distribution to the proper directory:<span class="Ignore"> &gt;</span>

<span class="Comment">    cp runtime/.clewn_keys.gdb        $CLEWNDIR</span>

or<span class="Ignore"> &gt;</span>

<span class="Comment">    cp runtime/.clewn_keys.gdb        $HOME</span>

The comments in the configuration file explain how to customize the key
mappings.

On Windows, the .pyclewn_keys.<span class="Special">{debugger}</span> configuration files are found in the
directory $VIM\vimfiles\macros. The value of $VIM can be obtained by running
the following command in Vim:<span class="Ignore"> &gt;</span>

<span class="Comment">    :echo $VIM</span>

Copy these files to the $CLEWNDIR or $HOME directory, and customize the key
mappings.


<span class="PreProc">==============================================================================</span>
7. Watched variables                                <span class="Ignore">*</span><span class="Constant">pyclewn-variable</span><span class="Ignore">*</span>

The vim watched variables buffer is named &quot;(clewn)_dbgvar&quot;.

<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">Cdbgvar</span><span class="Ignore">*</span>
The<span class="Ignore">|</span><span class="Identifier">Cdbgvar</span><span class="Ignore">|</span>command is used to create a gdb watched variable in the variables
buffer from any valid expression. A valid expression is an expression that is
valid in the current frame.
The argument of the<span class="Ignore">|</span><span class="Identifier">Cdbgvar</span><span class="Ignore">|</span>pyclewn command is the expression to be watched.
For example, to create a watched variable for the expression &quot;len - max&quot;:
<span class="Ignore">&gt;</span>
<span class="Comment">    :Cdbgvar len - max</span>

Upon creation, the watched variable is given a name by gdb, for example:
<span class="Special">&lt;var1&gt;</span>.
The watched variables buffer, &quot;(clewn)_dbgvar&quot;, is created upon creation of
the first watched variable. It is created but not displayed in a window.
To display &quot;(clewn)_dbgvar&quot; just after the creation of the first variable:<span class="Ignore"> &gt;</span>
<span class="Comment">    :e #</span>
or<span class="Ignore"> &gt;</span>
<span class="Comment">    CTL-^</span>

Use the following command to find the number <span class="Special">N</span> of the &quot;(clewn)_dbgvar&quot;
buffer:<span class="Ignore"> &gt;</span>
<span class="Comment">    :ls</span>

Knowing <span class="Special">N</span>, the following commands display the &quot;(clewn)_dbgvar&quot; buffer:<span class="Ignore"> &gt;</span>
<span class="Comment">    :Nb</span>
or<span class="Ignore"> &gt;</span>
<span class="Comment">    N CTL-^</span>

To split the current window and display &quot;(clewn)_dbgvar&quot;:<span class="Ignore"> &gt;</span>
<span class="Comment">    :Nsb</span>
.

<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">Cfoldvar</span><span class="Ignore">*</span>
When the watched variable is a structure or class instance, it can be expanded
with the<span class="Ignore">|</span><span class="Identifier">Cfoldvar</span><span class="Ignore">|</span>pyclewn command to display all its members and their values
as children watched variables.
The argument of the<span class="Ignore">|</span><span class="Identifier">Cfoldvar</span><span class="Ignore">|</span>command is the line number of the watched
variable to expand, in the watched variable window.
For example:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cfoldvar 1</span>

The<span class="Ignore">|</span><span class="Identifier">Cfoldvar</span><span class="Ignore">|</span>command is meant to be used in a key mapping. This is the 'X' key
when using pyclewn key mappings, or one can use the following mapping:
<span class="Ignore">&gt;</span>
<span class="Comment">    :map &lt;F8&gt; :exe &quot;Cfoldvar &quot; . line(&quot;.&quot;)&lt;CR&gt;</span>

The watched variable can also be collapsed with the<span class="Ignore">|</span><span class="Identifier">Cfoldvar</span><span class="Ignore">|</span>command.


<span class="Statement">                                                    </span><span class="Ignore">*</span><span class="Constant">Cdelvar</span><span class="Ignore">*</span>
A gdb watched variable can be deleted with the<span class="Ignore">|</span><span class="Identifier">Cdelvar</span><span class="Ignore">|</span>pyclewn command.
The argument of the<span class="Ignore">|</span><span class="Identifier">Cdelvar</span><span class="Ignore">|</span>command is the name of the variable as given by
gdb upon creation.
For example:<span class="Ignore"> &gt;</span>

<span class="Comment">    :Cdelvar var1</span>

When the watched variable is a structure or class instance and it has been
expanded, all its children are also deleted.


Highlighting:
<span class="PreProc">-------------</span>
When the value of a watched variable has changed, it is highlighted with the
&quot;Special&quot; highlight group.

When a watched variable becomes out of scope, it is highlighted with the
&quot;Comment&quot; highlight group.

The foreground and background colors used by these highlight groups are setup
by the<span class="Ignore">|</span><span class="Identifier">:colorscheme</span><span class="Ignore">|</span>currently in use.


<span class="PreProc">==============================================================================</span>
8. Extending pyclewn                                <span class="Ignore">*</span><span class="Constant">pyclewn-extending</span><span class="Ignore">*</span>


To implement a new debugger in pyclewn:

    1 - Add a module in the clewn.debugger package that implements a subclass
        of clewn.Application.

    2 - Update the pyclewn script to import the new clewn.Application
        subclass.

    3 - Update the pyclewn documentation at runtime/doc/pyclewn.txt

    4 - Run pychecker.sh and add tests to the testsuite

    5 - Update setup.py to import the new clewn.Application subclass. The
        .pyclewn_keys.<span class="Special">{debugger}</span> keys map file is automatically created when
        building the pyclewn source distribution with:<span class="Ignore"> &gt;</span>

<span class="Comment">            python setup.py sdist</span>


The interface between pyclewn and the debugger is documented in application.py.
This module contains the abstract class clewn.Application. The abstract class
clewn.Application provides the following methods to control gvim (see
application.py for the documentation):

console_print       print on the pyclewn gvim console
show_balloon        display a balloon in gvim
add_bp              add a breakpoint sign
delete_bp           delete a breakpoint sign
update_bp           change the state of a breakpoint sign
delete_all          remove signs
show_frame          show the sign of the line in the current frame
close               close the application and remove all signs

The (clewn)_dbgvar buffer is loaded by invoking its register method, and the
buffer content is updated with its update method. See the simple.py module for
an example.


Summary of the components of a subclass of clewn.Application that must be
implemented (the simple.py module can be used as an example):

    . class attributes that describe the available command line options

    . a dictionary of the debugger commands and their first argument
      completion

    . a list of illegal commands

    . a dictionary of the keys and their mappings

    . the implementation of the methods:
        default_cmd_processing
        pre_cmd
        post_cmd

    . the implementation of methods cmd_<span class="Special">&lt;name&gt;</span> for the debugger <span class="Special">&lt;name&gt;</span>
      commands; when the implementation of a method is missing for a debugger
      command, pyclewn invokes the default_cmd_processing method whose
      implementation is required


<span class="PreProc">==============================================================================</span>
$Id: pyclewn.txt 101 2009-04-12 19:56:00Z xavier $
vim:tw=78:ts=8:ft=help:norl:et:
</pre>
</body>
</html>
